<!DOCTYPE html>
<html lang="en">
<head>
  {% load static %}
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Register</title>

  
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link rel="icon" type="image/png" href="{% static 'media/PPMS-logo.png' %}">

  <style>
    /* Import Poppins font */
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');
    
    * {
      font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background-image: url("{% static 'media/loginbg.png' %}");
      background-size: cover;       
      background-repeat: no-repeat;
      background-position: center;
      min-height: 100vh;
      font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    /* Fade in animation */
    @keyframes fadeSlideDown {
      0% {
        opacity: 0;
        transform: translateY(-40px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    body.fade-in {
      animation: fadeSlideDown 0.6s ease-out;
    }

    @media (min-width: 992px) {
      body {
        background-attachment: fixed;
      }
    }

    @media (max-width: 991px) and (min-width: 576px) {
      body {
        background-position: top center;
      }
    }

    @media (max-width: 575px) {
      body {
        background-position: center top;
        background-size: contain;   
      }
    }

    .eye-icon {
      position: absolute;
      top: 72%;
      right: 20px;
      transform: translateY(-50%);
      cursor: pointer;
      width: 20px;
      height: 20px;
      transition: opacity 0.2s ease;
      opacity: 0.6;
    }

    .eye-icon:hover {
      opacity: 1;
    }

    /* Form styling */
    .form-container {
      backdrop-filter: blur(10px);
      background: rgba(255, 255, 255, 0.95);
      border-radius: 15px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    }

    .form-label {
      font-weight: 500;
      color: #333;
    }

    .form-control, .form-select {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 10px 12px;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .form-control:focus, .form-select:focus {
      border-color: #007bff;
      box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
    }

    .btn-primary {
      background-color: #007bff;
      border-color: #007bff;
      font-weight: 600;
      padding: 10px 0;
      border-radius: 8px;
      transition: all 0.3s ease;
    }

    .btn-primary:hover {
      background-color: #0056b3;
      border-color: #0056b3;
    }

    h2 {
      font-weight: 600;
      color: #333;
    }

    h5 {
      font-weight: 600;
      color: #333;
      margin-bottom: 1rem;
    }

    .policy-link {
      color: #007bff;
      text-decoration: none;
    }

    .policy-link:hover {
      text-decoration: underline;
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      padding-top: 60px;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow-y: auto;
      background-color: rgba(0, 0, 0, 0.6);
    }

    .modal-content {
      background-color: #fff;
      margin: auto;
      padding: 20px;
      width: 90%;
      max-width: 700px;
      border-radius: 10px;
      position: relative;
    }

    .modal-body {
      max-height: 60vh;
      overflow-y: auto;
      margin-top: 15px;
    }

    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }

    .close:hover {
      color: #000;
    }
  </style>
</head>
<body class="fade-in">

<!-- SweetAlert2 Django messages -->
{% if messages %}
  {% for message in messages %}
    <script>
      Swal.fire({
        icon: "{% if message.tags == 'success' %}success{% else %}error{% endif %}",
        title: "{{ message|escapejs }}",
        showConfirmButton: false,
        timer: 3000
      });
    </script>
  {% endfor %}
{% endif %}

<div class="container-fluid min-vh-100 d-flex align-items-center justify-content-center py-4">
  <div class="form-container p-4 w-100" style="max-width: 800px;">
    <h2 class="mb-4 text-center">Register Account</h2>

    <!-- Bootstrap Form -->
    <form id="registerForm" method="post" action="{% url 'register' %}">
      {% csrf_token %}

      <input type="hidden" id="role" name="role" value="">

      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="firstName" class="form-label">First Name</label>
          <input type="text" id="firstName" name="firstName" class="form-control" required>
        </div>
        <div class="col-md-6 mb-3">
          <label for="middleName" class="form-label">Middle Name</label>
          <input type="text" id="middleName" name="middleName" class="form-control" required>
        </div>
      </div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="lastName" class="form-label">Last Name</label>
          <input type="text" id="lastName" name="lastName" class="form-control" required>
        </div>
        <div class="col-md-6 mb-3">
          <label for="suffix" class="form-label">Suffix</label>
          <input type="text" id="suffix" name="suffix" class="form-control">
        </div>
      </div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="email" class="form-label">Email</label>
          <input type="email" id="email" name="email" class="form-control" required>
        </div>
        <div class="col-md-6 mb-3">
          <label for="contact" class="form-label">Contact Number</label>
          <input type="text" id="contact" name="contact" class="form-control" required maxlength="11" pattern="\d{11}" title="Contact number must be 11 digits">
        </div>
      </div>

      <div class="row">
        <div class="col-md-6 mb-3 position-relative">
          <label for="password" class="form-label">Password</label>
          <input type="password" id="password" name="password" class="form-control" required>
          <img id="togglePassword" class="eye-icon" src="{% static 'media/show-password.png' %}" alt="Show Password">
        </div>
        <div class="col-md-6 mb-3 position-relative">
          <label for="confirm" class="form-label">Confirm Password</label>
          <input type="password" id="confirm" name="confirm" class="form-control" required>
          <img id="toggleConfirmPassword" class="eye-icon" src="{% static 'media/show-password.png' %}" alt="Show Password">
        </div>
      </div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="birthdate" class="form-label">Birthdate</label>
          <input type="date" id="birthdate" name="birthdate" class="form-control" required>
          <input type="hidden" id="age" name="age">
        </div>
        <div class="col-md-6 mb-3">
          <label for="roleSelect" class="form-label">Select Role</label>
          <select id="roleSelect" name="role" class="form-select" required>
            <option value=""disabled selected>Select your role</option>
            <option value="BHW">Barangay Health Worker</option>
            <option value="Barangay Nutritional Scholar">Barangay Nutritional Scholar</option>
            <option value="Midwife">Midwife</option>
            <option value="Nurse">Nurse</option>
          </select>
        </div>
      </div>

      <!-- Sex Dropdown BELOW Birthdate -->
      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="sex" class="form-label">Sex</label>
          <select id="sex" name="sex" class="form-select" required>
            <option value="" disabled selected>Select</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
          </select>
        </div>
      </div>

      <!-- Address Section -->
      <h5 class="mt-4">
  Address <small class="text-muted" style="font-size: 0.75rem;">*If not applicable, put NA</small>
</h5>

<div class="row">
  <div class="col-md-3 mb-3">
    <label for="houseNumber" class="form-label">House Number</label>
    <input type="text" id="houseNumber" name="house_number" class="form-control" placeholder="Enter House Number">
  </div>
  <div class="col-md-3 mb-3">
    <label for="block" class="form-label">Block</label>
    <input type="text" id="block" name="block" class="form-control" placeholder="Enter Block">
  </div>
  <div class="col-md-3 mb-3">
    <label for="lot" class="form-label">Lot</label>
    <input type="text" id="lot" name="lot" class="form-control" placeholder="Enter Lot">
  </div>
  <div class="col-md-3 mb-3">
    <label for="phase" class="form-label">Phase</label>
    <input type="text" id="phase" name="phase" class="form-control" placeholder="Enter Phase">
  </div>
</div>

<div class="row">
  <div class="col-md-6 mb-3">
    <label for="street" class="form-label">Street</label>
    <input type="text" id="street" name="street" class="form-control" placeholder="Enter Street" required>
  </div>
  <div class="col-md-6 mb-3">
    <label for="subdivision" class="form-label">Subdivision</label>
    <input type="text" id="subdivision" name="subdivision" class="form-control" placeholder="Enter Subdivision">
  </div>
</div>

<div class="row">
  <div class="col-md-6 mb-3">
    <label for="city" class="form-label">City</label>
    <input type="text" id="city" name="city" class="form-control" placeholder="Enter City" required>
  </div>
  <div class="col-md-6 mb-3">
    <label for="province" class="form-label">Province</label>
    <input type="text" id="province" name="province" class="form-control" placeholder="Enter Province" required>
  </div>
</div>

      <div class="row">
        <div class="col-md-12 mb-3">
          <label for="barangay_id" class="form-label">Barangay</label>
          <select id="barangay_id" name="barangay_id" class="form-select" required>
            <option value="" disabled selected>Select your barangay</option>
            {% for barangay in barangays|dictsort:"name" %}
              <option value="{{ barangay.id }}">{{ barangay.name }}</option>
            {% endfor %}
          </select>
        </div>
      </div>

      <div class="mb-3 form-check">
        <input type="checkbox" id="agree" name="agree" class="form-check-input" required>
        <label for="agree" class="form-check-label">
          I agree to the 
          <a href="javascript:void(0);" id="openTerms" class="policy-link">Terms and Conditions</a> and 
          <a href="javascript:void(0);" id="openPrivacy" class="policy-link">Privacy Policy</a>.
        </label>
      </div>

      <button type="submit" class="btn btn-primary w-100">Register</button>
    </form>

    <div class="text-center mt-3">
      Already have an account? <a href="{% url 'login' %}" class="policy-link">Log in</a>
    </div>
  </div>
</div>

<!-- Terms Modal -->
<div id="termsModal" class="modal">
  <div class="modal-content">
    <span class="close" id="closeTerms">&times;</span>
    <h2>Terms and Conditions</h2>
    <div class="modal-body modal-scroll">
      <p><strong>Preschooler Profiling and Monitoring System</strong></p>
      <p><strong>Last updated:</strong> July 29, 2025</p>

      <h3>1. Introduction</h3>
      <p>These Terms and Conditions constitute a legally binding agreement between you, whether personally or on behalf of an entity and the development team from Technological University of the Philippines - Cavite, concerning your access to and use of the Preschooler Profiling and Monitoring System.</p>
      <p>By accessing or using our System, you agree that you have read, understood, and agree to be bound by these Terms. If you do not agree with these Terms, you are prohibited from using or accessing this System.</p>

      <h3>2. Acceptance of Terms</h3>
      <p>By creating an account, accessing, or using the Preschooler Profiling and Monitoring System, you acknowledge that you have read and understood these Terms and agree to be bound by them. These Terms apply to all users of the system, including health workers, administrators, parents, and educators.</p>

      <h3>3. Description of Service</h3>
      <p>The Preschooler Profiling and Monitoring System is a web-based application designed to help preschool institutions, daycare centers, barangay health workers, and authorized personnel track, monitor, and assess the developmental progress of preschool-aged children (ages 0-60 months). The System provides tools for:</p>
      <ul>
        <li>Preschooler profile management</li>
        <li>Developmental milestone tracking and assessment</li>
        <li>Health and nutritional status monitoring</li>
        <li>Early childhood development progress tracking</li>
        <li>Communication between educators, health workers, and parents/guardians</li>
        <li>Report generation and analytics for developmental assessments</li>
      </ul>

      <h3>4. User Eligibility and Account Registration</h3>
      <h4>4.1 Eligibility</h4>
      <p>You must be at least 18 years of age to use this System. By using the System, you represent and warrant that you meet this age requirement.</p>

      <h4>4.2 Account Registration</h4>
      <p>To access certain features of the System, you must register for an account. You agree to:</p>
      <ul>
        <li>Provide accurate, current, and complete information during registration</li>
        <li>Maintain and promptly update your account information</li>
        <li>Maintain the security and confidentiality of your login credentials</li>
        <li>Accept responsibility for all activities that occur under your account</li>
      </ul>

      <h4>4.3 Account Types</h4>
      <ul>
        <li>Health administrators</li>
        <li>Barangay health workers and community health personnel</li>
        <li>Parents and guardians (with appropriate authorization)</li>
      </ul>

      <h3>5. Acceptable Use Policy</h3>
      <h4>5.1 Permitted Uses</h4>
      <p>You may use the System only for lawful purposes and in accordance with these Terms. Specifically, you agree to use the System only for:</p>
      <ul>
        <li>Early childhood development and health assessment purposes</li>
        <li>Authorized monitoring of preschooler developmental progress</li>
        <li>Health and nutritional status tracking by qualified personnel</li>
        <li>Communication with authorized parties regarding child development and health</li>
        <li>Administrative tasks related to preschool institutions and community health programs</li>
      </ul>

      <h4>5.2 Prohibited Uses</h4>
      <p>You agree NOT to use the System:</p>
      <ul>
        <li>For any unlawful purpose or to solicit others to perform unlawful acts</li>
        <li>To violate any international, federal, provincial, or state regulations, rules, laws, or local ordinances</li>
        <li>To infringe upon or violate our intellectual property rights or the intellectual property rights of others</li>
        <li>To harass, abuse, insult, harm, defame, slander, disparage, intimidate, or discriminate</li>
        <li>To submit false or misleading information about children or their development</li>
        <li>To access or attempt to access accounts or data belonging to other users without authorization</li>
        <li>To interfere with, disrupt, or create an undue burden on the System or networks connected to the System</li>
      </ul>

      <h3>6. Privacy and Data Protection</h3>
      <h4>6.1 Child Privacy</h4>
      <p>We take the privacy and protection of children's information extremely seriously. Our collection, use, and disclosure of personal information, including sensitive information about preschoolers, is governed by our Privacy Policy, which is incorporated into these Terms by reference.</p>

      <h4>6.2 Data Privacy Act Compliance</h4>
      <p>We comply with the Data Privacy Act of 2012 (Republic Act No. 10173) of the Philippines and its implementing rules and regulations.</p>

      <h4>6.3 COPPA Compliance</h4>
      <p>We comply with the Children's Online Privacy Protection Act (COPPA) and other applicable privacy laws regarding the collection of information from children under 13 years of age.</p>

      <h4>6.4 Data Security</h4>
      <p>We implement appropriate security measures to protect against unauthorized access, alteration, disclosure, or destruction of personal information and data stored in our System.</p>

      <h3>7. Intellectual Property Rights</h3>
      <h4>7.1 Our Intellectual Property</h4>
      <p>The System and its original content remain the exclusive property of the Development Team from Technological University of the Philippines - Cavite and its licensors.</p>

      <h4>7.2 User Content</h4>
      <p>By submitting content, you grant us a non-exclusive, worldwide, royalty-free license to use such content solely for providing the Service.</p>

      <h4>7.3 Restrictions</h4>
      <ul>
        <li>Reproduce, distribute, modify, create derivative works of, publicly display, publicly perform, republish, download, store, or transmit any material on our System</li>
        <li>Reverse engineer, decompile, or disassemble the System</li>
        <li>Remove or alter any copyright, trademark, or other proprietary rights notices</li>
      </ul>

      <h3>8. User Responsibilities</h3>
      <h4>8.1 Data Accuracy</h4>
      <p>Users are responsible for ensuring that all information entered into the System regarding preschoolers is accurate, current, and obtained through appropriate and ethical means.</p>

      <h4>8.2 Authorization</h4>
      <p>Users must ensure they have proper authorization to input, access, and share information about the children in their care or under their educational supervision.</p>

      <h4>8.3 Professional Standards</h4>
      <p>Educators, health workers, and administrators using the System must adhere to their professional standards and ethical guidelines.</p>

      <h3>9. Termination</h3>
      <p>We may suspend or terminate accounts for violations. Data retention after termination is handled per our Privacy Policy.</p>

      <h3>10. Disclaimers</h3>
      <p>The System is provided "AS IS" and intended as an educational monitoring tool, not a substitute for professional medical or educational assessments.</p>

      <h3>11. Limitation of Liability</h3>
      <p>The development team shall not be liable for indirect, incidental, or consequential damages arising from use of the System.</p>

      <h3>12. Indemnification</h3>
      <p>You agree to indemnify and hold harmless the development team and its affiliates against claims, damages, or expenses arising from your use of the System.</p>

      <h3>13. Governing Law</h3>
      <p>These Terms are governed by the laws of the Republic of the Philippines.</p>

      <h3>14. Changes to Terms</h3>
      <p>We reserve the right to modify these Terms at any time. Material changes will be communicated in advance.</p>

      <h3>15. Severability</h3>
      <p>If any provision is deemed invalid, the remaining provisions remain enforceable.</p>

      <h3>16. Contact Information</h3>
      <p><strong>Thesis Development Team</strong><br>
      Technological University of the Philippines - Cavite<br>
      Email: ppms.cluster4imus@gmail.com<br>
      Address: Technological University of the Philippines - Cavite Campus, Cavite, Philippines</p>

      <p><em>By using the Preschooler Profiling and Monitoring System, you acknowledge that you have read and understood these Terms and Conditions and agree to be bound by them.</em></p>
    </div>
  </div>
</div>

<!-- Privacy Policy Modal -->
<div id="privacyModal" class="modal">
  <div class="modal-content">
    <span class="close" id="closePrivacy">&times;</span>
    <h2>Privacy Policy</h2>
    <div class="modal-body modal-scroll">
      <p><strong>Effective Date:</strong> July 29, 2025</p>
      <p>This Privacy Policy explains how the Preschooler Profiling and Monitoring System (PPMS) collects, uses, and protects your personal data in compliance with the Data Privacy Act of 2012 (Republic Act No. 10173), COPPA, and other applicable laws.</p>

      <h3>1. Scope</h3>
      <p>This Policy applies to all users of the PPMS, including health workers, administrators, parents, and guardians.</p>

      <h3>2. Data We Collect</h3>
      <ul>
        <li><strong>Personal Information:</strong> Name, birthdate, address, contact details, parent/guardian information.</li>
        <li><strong>Sensitive Personal Information:</strong> Preschooler health records, developmental assessments, nutritional status, and other related health data.</li>
      </ul>

      <h3>3. Purpose of Data Processing</h3>
      <p>We collect and process data solely for the following purposes:</p>
      <ul>
        <li>Preschooler health monitoring and BMI assessment</li>
        <li>Developmental milestone and progress tracking</li>
        <li>Communication between health workers, educators, and parents</li>
        <li>Compliance with public health programs and reporting requirements</li>
      </ul>

      <h3>4. Legal Basis for Processing</h3>
      <p>Data processing is carried out based on:</p>
      <ul>
        <li>Your consent</li>
        <li>Legitimate interests of early childhood health monitoring</li>
        <li>Compliance with applicable laws and regulations</li>
      </ul>

      <h3>5. Data Sharing and Disclosure</h3>
      <p>Data will only be shared with:</p>
      <ul>
        <li>Authorized barangay health workers, administrators, and system personnel</li>
        <li>Government agencies (e.g., Department of Health) when legally required</li>
        <li>Researchers and academic partners, only with anonymized data</li>
      </ul>

      <h3>6. Data Retention</h3>
      <p>Data is retained only as long as necessary for its intended purpose or as required by law. Upon account termination, retention and deletion follow our Terms and Privacy Policy.</p>

      <h3>7. Children's Privacy</h3>
      <p>We strictly comply with COPPA and RA 10173 in handling preschooler data. No data is collected directly from children without parental or guardian authorization.</p>

      <h3>8. Your Rights</h3>
      <p>Under RA 10173, you have the right to:</p>
      <ul>
        <li>Access, update, or correct your data</li>
        <li>Request deletion or blocking of personal data</li>
        <li>Withdraw consent to data processing</li>
        <li>File a complaint with the National Privacy Commission (NPC)</li>
      </ul>

      <h3>9. Security Measures</h3>
      <p>We implement organizational, physical, and technical measures to protect personal data against unauthorized access, alteration, disclosure, or destruction.</p>

      <h3>10. Updates to this Policy</h3>
      <p>This Privacy Policy may be updated from time to time. Users will be notified of significant changes.</p>

      <h3>11. Contact Information</h3>
      <p><strong>Thesis Development Team</strong><br>
      Technological University of the Philippines - Cavite<br>
      Email: ppms.cluster4imus@gmail.com<br>
      Address: Technological University of the Philippines - Cavite Campus, Cavite, Philippines</p>
    </div>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function () {
  const firstName = document.getElementById('firstName');
  const lastName = document.getElementById('lastName');
  const street = document.getElementById('street');
  const city = document.getElementById('city');
  const province = document.getElementById('province');
  const subdivision = document.getElementById('subdivision');
  const houseNumber = document.getElementById('houseNumber');
  const block = document.getElementById('block');
  const lot = document.getElementById('lot');
  const phase = document.getElementById('phase');
  const email = document.getElementById('email');
  const contact = document.getElementById('contact');
  const password = document.getElementById('password');
  const confirm = document.getElementById('confirm');
  const form = document.getElementById('registerForm');
  const barangaySelect = document.getElementById('barangay_id');
  const birthdate = document.getElementById('birthdate');
  const ageInput = document.getElementById('age');
  const agree = document.getElementById('agree');
  const togglePassword = document.getElementById("togglePassword");
  const toggleConfirmPassword = document.getElementById("toggleConfirmPassword");
  const roleSelect = document.getElementById("roleSelect");
  const roleInput = document.getElementById("role");

  // Role dropdown functionality
  roleSelect.addEventListener("change", () => {
    roleInput.value = roleSelect.value;
  });

  // Password toggle functionality
  function setupPasswordToggle(toggleId, inputId) {
    const toggle = document.getElementById(toggleId);
    const input = document.getElementById(inputId);

    if (toggle && input) {
      toggle.addEventListener("click", function () {
        const isPassword = input.type === "password";
        input.type = isPassword ? "text" : "password";

        toggle.src = isPassword 
          ? "{% static 'media/hide-password.png' %}" 
          : "{% static 'media/show-password.png' %}";
        toggle.alt = isPassword ? "Hide Password" : "Show Password";
      });
    }
  }

  // Initialize toggles
  setupPasswordToggle("togglePassword", "password");
  setupPasswordToggle("toggleConfirmPassword", "confirm");
  const middleName = document.getElementById('middleName');
  const suffix = document.getElementById('suffix');

  // Input validation
  [firstName, middleName, lastName, suffix].forEach(input => input.addEventListener('input', e => {
    e.target.value = e.target.value.replace(/[^a-zA-Z\s]/g, '').replace(/^\s+|\s{2,}/g, ' ');
  }));

  // Address field validation including subdivision
  [street, city, province, subdivision].forEach(input => {
    input.addEventListener('input', e => {
      e.target.value = e.target.value
        .replace(/[^a-zA-Z0-9\s.,#/-]/g, '') 
        .replace(/^\s+|\s{2,}/g, ' ');       
    });

    // Capitalize "n/a" on blur
    input.addEventListener('blur', e => {
      if (e.target.value.trim().toLowerCase() === 'n/a') {
        e.target.value = 'N/A';
      }
    });
  });

  // House/Block/Lot/Phase field validation - NUMBERS ONLY (and NA)
  [houseNumber, block, lot, phase].forEach(input => {
    input.addEventListener('input', e => {
      // Allow only numbers and "NA" (case insensitive)
      let value = e.target.value.toUpperCase();
      
      // If user is typing "NA", allow it
      if (value === 'N' || value === 'NA') {
        e.target.value = value;
      } else {
        // Otherwise, only allow numbers
        e.target.value = e.target.value.replace(/[^0-9]/g, '');
      }
    });

    // Handle "na" conversion on blur
    input.addEventListener('blur', e => {
      if (e.target.value.trim().toLowerCase() === 'n' || 
          e.target.value.trim().toLowerCase() === 'na') {
        e.target.value = 'NA';
      }
    });
  });

  email.addEventListener('input', e => e.target.value = e.target.value.replace(/\s/g, ''));
  contact.addEventListener('input', e => e.target.value = e.target.value.replace(/\D/g, '').slice(0, 11));
  [password, confirm].forEach(input => input.addEventListener('input', e => e.target.value = e.target.value.replace(/[^a-zA-Z0-9]/g, '')));

  // Birthdate and age calculation
  if (birthdate) {
    birthdate.max = new Date().toISOString().split("T")[0];
    birthdate.addEventListener("change", () => {
      const birth = new Date(birthdate.value);
      const today = new Date();
      let age = today.getFullYear() - birth.getFullYear();
      if (today.getMonth() < birth.getMonth() || (today.getMonth() === birth.getMonth() && today.getDate() < birth.getDate())) age--;
      ageInput.value = age;
    });
  }

  // Form submission validation
  form.addEventListener('submit', function (e) {
    if (!agree.checked) {
      e.preventDefault();
      Swal.fire({ icon: 'warning', title: 'Agreement Required', text: 'You must agree to the Terms and Conditions and Privacy Policy.' });
      return;
    }
    if (password.value !== confirm.value) {
      e.preventDefault();
      Swal.fire({ icon: 'error', title: 'Passwords do not match' });
      return;
    }
    if (!barangaySelect.value) {
      e.preventDefault();
      Swal.fire({ icon: 'warning', title: 'Barangay Required', text: 'Please select your barangay.' });
      return;
    }
    if (!roleSelect.value) {
      e.preventDefault();
      Swal.fire({ icon: 'warning', title: 'Role Required', text: 'Please select your role.' });
      return;
    }
  });

  // Modal functionality
  const termsModal = document.getElementById("termsModal");
  const privacyModal = document.getElementById("privacyModal");
  
  document.getElementById("openTerms").onclick = () => termsModal.style.display = "block";
  document.getElementById("openPrivacy").onclick = () => privacyModal.style.display = "block";
  document.getElementById("closeTerms").onclick = () => termsModal.style.display = "none";
  document.getElementById("closePrivacy").onclick = () => privacyModal.style.display = "none";
  
  window.onclick = function (event) {
    if (event.target === termsModal) termsModal.style.display = "none";
    if (event.target === privacyModal) privacyModal.style.display = "none";
  };
});
</script>

</body>
</html>



